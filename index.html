<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Pet Keeper</title>
<style>
body{margin:0;font-family:sans-serif;background:#111;color:#eee}
h1,h2{margin:6px 0}
button{padding:6px 10px;margin:4px;background:#333;color:#eee;border:1px solid #555;cursor:pointer}
button:hover{background:#444}
.panel{border:1px solid #333;margin:8px;padding:8px;border-radius:6px}
.pet{border:1px solid #444;margin:6px;padding:6px;border-radius:6px}
.small{font-size:12px;color:#aaa}
input{background:#222;color:#eee;border:1px solid #555;padding:4px}
</style>
</head>
<body>

<h1>ğŸ¾ é¤Šå¯µç‰©éŠæˆ²</h1>

<div class="panel">
<div>é‡‘å¹£ï¼š<span id="gold">0</span></div>
<div>ç¸½åŠ æˆï¼š<span id="bonus">1.00</span>x</div>
<button onclick="saveGame()">å­˜æª”</button>
<button onclick="resetGame()">é‡ç½®</button>
</div>

<div class="panel">
<h2>ğŸ® å°éŠæˆ²</h2>
<button onclick="gameClick()">é»æ“ŠéŠæˆ²</button>
<button onclick="gameGuess()">çŒœæ•¸å­—</button>
<button onclick="gameCoinFlip()">æ“²ç¡¬å¹£</button>
<button onclick="gameTimer()">åæ‡‰æ¸¬è©¦</button>
<div class="small">æ‰€æœ‰æ”¶ç›Šéƒ½æœƒåƒåŠ æˆ</div>
</div>

<div class="panel">
<h2>ğŸ– å•†åº—</h2>
<button onclick="buyFood()">è³¼è²·é£¼æ–™ï¼ˆ50 é‡‘å¹£ï¼‰</button>
<div>é£¼æ–™æ•¸é‡ï¼š<span id="food">0</span></div>
<hr>
<div id="shop"></div>
</div>

<div class="panel">
<h2>ğŸ¶ æˆ‘çš„å¯µç‰©</h2>
<div id="owned"></div>
</div>

<script>
const PETS=[
{name:"å²èŠå§†å•¾",price:50,bonus:0.05},
{name:"ç°å°¾é¼ ",price:80,bonus:0.06},
{name:"ç«è‹—èœ¥",price:120,bonus:0.08},
{name:"è—ç¾½é³¥",price:150,bonus:0.1},
{name:"çŸ³æ®¼é¾œ",price:200,bonus:0.12},
{name:"å¤œè²“å½±",price:260,bonus:0.14},
{name:"é¢¨è§’ç¾Š",price:320,bonus:0.16},
{name:"é›·èŠ½ç‹",price:380,bonus:0.18},
{name:"éœ§é±—è›‡",price:450,bonus:0.2},
{name:"éµç‰™çŠ¬",price:520,bonus:0.22},
{name:"æ™¶çœ¼è²“",price:600,bonus:0.25},
{name:"å²©èƒŒç†Š",price:700,bonus:0.28},
{name:"æ˜Ÿç´‹é¹¿",price:820,bonus:0.32},
{name:"æ²™çˆªè ",price:950,bonus:0.36},
{name:"æœˆå½±ç‹¼",price:1100,bonus:0.4},
{name:"æ½®æ±é¾œ",price:1300,bonus:0.45},
{name:"ç†”æ ¸èœ¥",price:1550,bonus:0.5},
{name:"é›·è§’ç‰›",price:1800,bonus:0.55},
{name:"å¹½ç‡¼é³¥",price:2100,bonus:0.6},
{name:"å†°æ™¶ç‹",price:2450,bonus:0.65},
{name:"è’¼ç¿¼é¾",price:2850,bonus:0.7},
{name:"æ·±æµ·é­·",price:3300,bonus:0.75},
{name:"è’åŸè±¡",price:3800,bonus:0.8},
{name:"é›·é³´è™",price:4350,bonus:0.85},
{name:"å¤œç´‹è±¹",price:4950,bonus:0.9},
{name:"æ˜Ÿå¡µå…”",price:5600,bonus:0.95},
{name:"é‡‘ç¾½é·¹",price:6300,bonus:1.0},
{name:"è™›ç©ºè›‡",price:7050,bonus:1.05},
{name:"è£‚å²©çŠ€",price:7850,bonus:1.1},
{name:"è’¼é›·é¯¨",price:8700,bonus:1.15},
{name:"å¹»ç„°é¹¿",price:9600,bonus:1.2},
{name:"å½±é§ç†Š",price:10500,bonus:1.25},
{name:"æ˜Ÿå† ç‹",price:11500,bonus:1.3},
{name:"é›·ç´‹çŒ¿",price:12600,bonus:1.35},
{name:"æ·±æ·µé¾",price:13800,bonus:1.4},
{name:"ç¥æœ¨é¹¿",price:15100,bonus:1.45},
{name:"ç†¾é™½é³¥",price:16500,bonus:1.5},
{name:"å†¥æ²³é¾œ",price:18000,bonus:1.55},
{name:"å¤©ç©¹è™",price:19600,bonus:1.6},
{name:"å¹»æ˜Ÿè²“",price:21300,bonus:1.65},
{name:"é›·å†•ç…",price:23100,bonus:1.7},
{name:"è™›æ™¶è›‡",price:25000,bonus:1.75},
{name:"è’¼å¤œç‹¼",price:27000,bonus:1.8},
{name:"ç¥ç„°é³³",price:29100,bonus:1.85},
{name:"æ··æ²Œé¾",price:31300,bonus:1.9},
{name:"æ™‚åºé¹¿",price:33600,bonus:1.95},
{name:"ç„¡å é¯¨",price:36000,bonus:2.0},
{name:"çµ‚ç„‰ç¸",price:38500,bonus:2.2}
];

let game={
gold:0,
food:0,
owned:[]
};

function stageName(lv){
return ["å¹¼é«”","æˆé•·","æˆç†Ÿ","å®Œå…¨é«”"][lv];
}

function totalBonus(){
let b=1;
game.owned.forEach(p=>{
b+=p.bonus*(1+p.level*0.5);
});
return b;
}

function saveGame(){
localStorage.setItem("petGameSave",JSON.stringify(game));
}

function loadGame(){
const d=localStorage.getItem("petGameSave");
if(d)game=JSON.parse(d);
updateUI();
}

function resetGame(){
localStorage.removeItem("petGameSave");
location.reload();
}

function earn(base){
game.gold+=Math.floor(base*totalBonus());
updateUI();saveGame();
}

function gameClick(){earn(10);}
function gameGuess(){
  const input = prompt("çŒœ 1~5ï¼ˆä¸€å®šè¦è¼¸å…¥æ•¸å­—ï¼‰");
  if(input === null) return; // ä½¿ç”¨è€…å–æ¶ˆ

  const g = parseInt(input, 10);
  if(isNaN(g) || g < 1 || g > 5){
    alert("è«‹è¼¸å…¥ 1~5 çš„æ•¸å­—");
    return;
  }

  const n = Math.floor(Math.random()*5) + 1;

  if(g === n){
    const reward = 80;
    earn(reward);
    alert("ğŸ‰ çŒœä¸­äº†ï¼ç²å¾— " + reward + " é‡‘å¹£");
  }else{
    alert("âŒ çŒœéŒ¯äº†ï¼Œç­”æ¡ˆæ˜¯ " + n);
  }
}

function gameCoinFlip(){
  if(Math.random() < 0.5){
    earn(40);
    alert("æ­£é¢ï¼+40");
  }else{
    game.gold = Math.max(0, game.gold - 20);
    updateUI(); saveGame();
    alert("åé¢ï¼-20");
  }
}

function gameTimer(){
  const start = Date.now();

  setTimeout(()=>{
    const shownAt = Date.now();

    if(confirm("ç¾åœ¨é» OK")){
      const reaction = Date.now() - shownAt;
      let reward = 0;

      // åæ‡‰å¿«ï¼š60~110
      if(reaction <= 300){
        reward = 110 - Math.floor(reaction / 6);
        if(reward < 60) reward = 60;
      }
      // æ™®é€šåæ‡‰ï¼š20~50
      else if(reaction <= 800){
        reward = 50 - Math.floor((reaction - 300) / 10);
        if(reward < 20) reward = 20;
      }
      // è¶…æ…¢ï¼š0
      else{
        reward = 0;
      }

      earn(reward);
    }
  }, Math.random()*2000 + 1000);
}

function buyFood(){
if(game.gold>=50){game.gold-=50;game.food++;}
updateUI();saveGame();
}

function feedPet(i){
if(game.food<=0)return;
const p=game.owned[i];
game.food--;
p.exp+=1;
if(p.exp>=3&&p.level<3){
p.exp=0;p.level++;
}
updateUI();saveGame();
}

function buyPet(i){
const p=PETS[i];
if(game.gold>=p.price){
game.gold-=p.price;
game.owned.push({...p,level:0,exp:0});
}
updateUI();saveGame();
}

function updateUI(){
document.getElementById("gold").textContent=game.gold;
document.getElementById("bonus").textContent=totalBonus().toFixed(2);
document.getElementById("food").textContent=game.food;

const shop=document.getElementById("shop");
shop.innerHTML="";
PETS.forEach((p,i)=>{
const d=document.createElement("div");
d.className="pet";
d.innerHTML=`<b>${p.name}</b><br>åƒ¹æ ¼:${p.price}<br>åŸºç¤åŠ æˆ:+${p.bonus}`;
const b=document.createElement("button");
b.textContent="è³¼è²·";
b.onclick=()=>buyPet(i);
d.appendChild(b);
shop.appendChild(d);
});

const owned=document.getElementById("owned");
owned.innerHTML="";
game.owned.forEach((p,i)=>{
const d=document.createElement("div");
d.className="pet";
d.innerHTML=`<b>${p.name}</b><br>
éšæ®µ:${stageName(p.level)}<br>
åŠ æˆ:${(p.bonus*(1+p.level*0.5)).toFixed(2)}`;
const b=document.createElement("button");
b.textContent="é¤µé£Ÿ";
b.onclick=()=>feedPet(i);
d.appendChild(b);
owned.appendChild(d);
});
}

<script>
loadGame();

// æ„›å¿ƒç²’å­ç¨‹å¼ç¢¼ä¹Ÿæ”¾åœ¨é€™è£¡
const bgCanvas = document.getElementById("heartBgCanvas");
const bgCtx = bgCanvas.getContext("2d");

function resizeBgCanvas() {
  bgCanvas.width = window.innerWidth;
  bgCanvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeBgCanvas);
resizeBgCanvas();

const bgHearts = [];
const maxHearts = 50;

function createHeart(){
  bgHearts.push({
    x: Math.random() * bgCanvas.width,
    y: -10,
    vy: 0.5 + Math.random()*1,
    vx: Math.random()*0.5-0.25,
    size: 5 + Math.random()*10,
    alpha: 0.4 + Math.random()*0.6
  });
}

function drawBgHeart(h){
  bgCtx.save();
  bgCtx.translate(h.x, h.y);
  bgCtx.scale(h.size/20, h.size/20);
  bgCtx.globalAlpha = h.alpha;
  bgCtx.fillStyle = "#ff6fae";

  bgCtx.beginPath();
  bgCtx.moveTo(0,6);
  bgCtx.bezierCurveTo(-10,-6,-20,8,0,22);
  bgCtx.bezierCurveTo(20,8,10,-6,0,6);
  bgCtx.fill();

  bgCtx.restore();
}

function updateBgHearts(){
  bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height);

  if(bgHearts.length < maxHearts){
    createHeart();
  }

  for(let i = bgHearts.length-1; i>=0; i--){
    const h = bgHearts[i];
    h.x += h.vx;
    h.y += h.vy;

    drawBgHeart(h);

    if(h.y > bgCanvas.height+20 || h.x < -20 || h.x > bgCanvas.width+20){
      bgHearts.splice(i,1);
    }
  }

  requestAnimationFrame(updateBgHearts);
}

updateBgHearts();
</script>

<canvas id="heartBgCanvas"></canvas>
</body>
</html>

